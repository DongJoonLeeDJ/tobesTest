
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCMS í†µí•© ì›ê°€ê´€ë¦¬ ì‹œìŠ¤í…œ - Ultimate Version</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
.nav-tab {
  padding: 1rem 2rem; /* ê°€ë¡œ íŒ¨ë”©ì„ 2remìœ¼ë¡œ ë„“í˜€ì„œ í´ë¦­ ì˜ì—­ í™•ëŒ€ */
}
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
.tab-content {
  border-top: 1px solid #e1e8ed;
  /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ ìœ ì§€ */
}

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
.dashboard-card {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
@media (max-width: 768px) {
  .container { padding: 1rem 0.5rem; }
}

        .header .subtitle {
            opacity: 0.9;
            font-size: 0.9rem;
            font-weight: 300;
        }

        .container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .nav-tab {
            flex: 1;
            padding: 1rem 1.5rem;
            background: #f8f9fa;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .nav-tab.active {
            background: white;
            color: #3498db;
            border-bottom: 3px solid #3498db;
        }

        .nav-tab:hover {
            background: #e9ecef;
        }

        /* íƒ­ ì½˜í…ì¸  */
        .tab-content {
            background: white;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 25px rgba(0,0,0,0.08);
            min-height: 600px;
        }

        .tab-pane {
            display: none;
            padding: 2rem;
        }

        .tab-pane.active {
            display: block;
        }

        /* ì—…ë¡œë“œ ì˜ì—­ */
        .upload-zone {
            border: 3px dashed #3498db;
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            background: linear-gradient(135deg, #f8fcff 0%, #e3f2fd 100%);
            transition: all 0.3s ease;
            margin-bottom: 2rem;
        }

        .upload-zone.dragover {
            border-color: #2ecc71;
            background: linear-gradient(135deg, #f0fff4 0%, #e8f5e8 100%);
        }

        .upload-zone input[type="file"] {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        /* ìˆ˜ë™ ì…ë ¥ í¼ */
        .manual-form {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .required {
            color: #e74c3c;
        }

        .form-control {
            padding: 0.75rem;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-control.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }

        .cost-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            margin: 1rem 0;
        }

        .cost-amount {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* ì§„í–‰ë¥  ë°” */
        .progress-container {
            margin: 1rem 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ìš”ì•½ ì¹´ë“œ (ë‘ ë²ˆì§¸ íŒŒì¼ ìŠ¤íƒ€ì¼ ì ìš©) */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .summary-card {
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-left: 4px solid;
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        .summary-card:hover {
            transform: translateY(-5px);
        }

        .summary-card.cost {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fff 0%, #fdf2f2 100%);
        }

        .summary-card.production {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #fff 0%, #f0f8ff 100%);
        }

        .summary-card.efficiency {
            border-left-color: #2ecc71;
            background: linear-gradient(135deg, #fff 0%, #f0fff0 100%);
        }

        .summary-card.target {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fff 0%, #fffaf0 100%);
        }

        .summary-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .summary-label {
            color: #7f8c8d;
            font-size: 0.95rem;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        /* ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ (ë‘ ë²ˆì§¸ íŒŒì¼ ìŠ¤íƒ€ì¼) */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
.dashboard-card.wide {
    grid-column: 1 / -1;
}
        .dashboard-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #e8eef3;
            transition: all 0.3s ease;
            height: fit-content;
        }

        .dashboard-card:hover {
            box-shadow: 0 8px 35px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 0.75rem;
        }

        /* ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ */
        .chart-container {
            position: relative;
            height: 320px;
            width: 100%;
        }

        /* ì§„í–‰ë¥  ì„¹ì…˜ (ë‘ ë²ˆì§¸ íŒŒì¼ì—ì„œ ê°€ì ¸ì˜´) */
        .progress-section {
            margin: 1.5rem 0;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .progress-label {
            font-weight: 500;
            color: #2c3e50;
        }

        .progress-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .progress-bar-custom {
            width: 100%;
            height: 12px;
            background-color: #ecf0f1;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill-custom {
            height: 100%;
            background: linear-gradient(90deg, #3498db 0%, #2ecc71 100%);
            transition: width 0.6s ease-in-out;
            border-radius: 8px;
            position: relative;
        }

        .progress-fill-custom::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.3) 50%,
                transparent 100%
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* ë¹ ë¥¸ ì…ë ¥ ìœ„ì ¯ */
        .quick-input-widget {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .input-row {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* ë°ì´í„° í…Œì´ë¸” */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .table-header {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
            vertical-align: middle;
        }

        .data-table th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            font-weight: 600;
            color: #2c3e50;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table tr {
            transition: background-color 0.2s ease;
        }

        .data-table tr:hover {
            background-color: #f8f9fa;
        }

        .data-table tr.new-entry {
            background-color: #e8f5e8;
            animation: highlightNew 2s ease-out;
        }

        @keyframes highlightNew {
            0% { background-color: #2ecc71; color: white; }
            100% { background-color: #e8f5e8; color: inherit; }
        }

        .status-badge {
            padding: 0.35rem 0.75rem;
            border-radius: 25px;
            font-size: 0.8rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .status-normal {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* ì•Œë¦¼ ì¹´ë“œ (ë‘ ë²ˆì§¸ íŒŒì¼ì—ì„œ ê°€ì ¸ì˜´) */
        .alert {
            padding: 1.25rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .alert-warning {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-left-color: #f39c12;
            color: #856404;
        }

        .alert-success {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left-color: #2ecc71;
            color: #155724;
        }

        .alert strong {
            display: block;
            margin-bottom: 0.5rem;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        /* ì•Œë¦¼ ì‹œìŠ¤í…œ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            background-color: #2ecc71;
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.25);
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.4s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background-color: #e74c3c;
        }

        .notification.warning {
            background-color: #f39c12;
        }

        .notification.info {
            background-color: #3498db;
        }

        /* ë¶„ë¥˜ í•„í„° */
        .filter-section {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-select {
            padding: 0.5rem 1rem;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            background: white;
            font-size: 0.9rem;
        }

        .filter-select:focus {
            outline: none;
            border-color: #3498db;
        }

        /* í…ìŠ¤íŠ¸ì—ì–´ë¦¬ì–´ */
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 1rem;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            resize: vertical;
            font-family: inherit;
            font-size: 0.9rem;
            line-height: 1.5;
            background-color: #fafbfc;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .summary-cards {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .form-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- ì•Œë¦¼ ë©”ì‹œì§€ -->
    <div id="notification" class="notification"></div>

    <div class="header">
        <h1>ğŸ­ ê¸ˆí˜• ì›ê°€ê´€ë¦¬ ì‹œìŠ¤í…œ (SCMS)</h1>
        <div class="subtitle">Excel ì—…ë¡œë“œ + ìˆ˜ë™ ì…ë ¥ í•˜ì´ë¸Œë¦¬ë“œ ì†”ë£¨ì…˜ - ì—ì´ì¹˜ ì—ì´ ì—” í…Œí¬</div>
    </div>

    <div class="container">
        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('upload')">
                ğŸ“¤ ì—‘ì…€ ì—…ë¡œë“œ
            </button>
            <button class="nav-tab" onclick="switchTab('manual')">
                âœï¸ ìˆ˜ë™ ì…ë ¥
            </button>
            <button class="nav-tab" onclick="switchTab('dashboard')">
                ğŸ“Š ëŒ€ì‹œë³´ë“œ
            </button>
            <button class="nav-tab" onclick="switchTab('list')">
                ğŸ“‹ ë°ì´í„° ëª©ë¡
            </button>
        </div>

        <div class="tab-content">
            <!-- ì—‘ì…€ ì—…ë¡œë“œ íƒ­ -->
            <div id="upload" class="tab-pane active">
                <h2 style="margin-bottom: 1.5rem;">ğŸ“¤ ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ</h2>

                <div class="alert alert-info">
                    <span>â„¹ï¸</span>
                    <div>
                        <strong>ì—…ë¡œë“œ ê°€ëŠ¥í•œ íŒŒì¼:</strong> .xlsx, .xls íŒŒì¼<br>
                        <strong>í•„ìˆ˜ ì»¬ëŸ¼:</strong> ëŒ€ë¶„ë¥˜, ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜, ê¸ˆí˜•ëª…, ì›ê°€, ìƒíƒœ, ë“±ë¡ì¼
                    </div>
                </div>

                <div class="upload-zone" id="uploadZone">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“</div>
                    <h3>íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”</h3>
                    <p style="color: #7f8c8d; margin-top: 0.5rem;">
                        Excel íŒŒì¼(.xlsx, .xls)ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤
                    </p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls">
                    <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                        ğŸ“‚ íŒŒì¼ ì„ íƒí•˜ê¸°
                    </button>
                </div>

                <div class="progress-container" id="progressContainer">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span>ì—…ë¡œë“œ ì§„í–‰ë¥ </span>
                        <span id="progressText">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>

                <div id="uploadResult"></div>

                <!-- ìƒ˜í”Œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ -->
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="btn btn-success" onclick="downloadSample()">
                        ğŸ“¥ ìƒ˜í”Œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                    </button>
                </div>
            </div>

            <!-- ìˆ˜ë™ ì…ë ¥ íƒ­ -->
            <div id="manual" class="tab-pane">
                <h2 style="margin-bottom: 1.5rem;">âœï¸ ì›ê°€ ë°ì´í„° ìˆ˜ë™ ì…ë ¥</h2>

                <div class="alert alert-info">
                    <span>ğŸ’¡</span>
                    <div>
                        <strong>ë¹ ë¥¸ ì…ë ¥ íŒ:</strong> í•„ìˆ˜ í•­ëª©ë§Œ ì…ë ¥í•˜ê³  ì €ì¥í•˜ë©´ ë©ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ëŠ” ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤.
                    </div>
                </div>

                <form class="manual-form" id="manualForm">
                    <!-- ë¶„ë¥˜ ì •ë³´ -->
                    <h3 style="margin-bottom: 1rem; color: #2c3e50;">ğŸ·ï¸ ë¶„ë¥˜ ì •ë³´</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="majorCategory">ëŒ€ë¶„ë¥˜ <span class="required">*</span></label>
                            <select id="majorCategory" class="form-control" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="ê°€ê³µ">ê°€ê³µ</option>
                                <option value="ì¬ë£Œ">ì¬ë£Œ</option>
                                <option value="ì¡°ë¦½">ì¡°ë¦½</option>
                                <option value="ê²€ì‚¬">ê²€ì‚¬</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="middleCategory">ì¤‘ë¶„ë¥˜ <span class="required">*</span></label>
                            <select id="middleCategory" class="form-control" required>
                                <option value="">ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="minorCategory">ì†Œë¶„ë¥˜ <span class="required">*</span></label>
                            <select id="minorCategory" class="form-control" required>
                                <option value="">ì¤‘ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>
                    </div>

                    <!-- ê¸°ë³¸ ì •ë³´ -->
                    <h3 style="margin-bottom: 1rem; color: #2c3e50;">ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="moldName">ê¸ˆí˜•ëª… <span class="required">*</span></label>
                            <input type="text" id="moldName" class="form-control" placeholder="ì˜ˆ: T0-ê°€ê³µë¹„" required>
                        </div>
                        <div class="form-group">
                            <label for="cost">ì›ê°€ <span class="required">*</span></label>
                            <input type="number" id="cost" class="form-control" placeholder="ë§Œì› ë‹¨ìœ„" min="0" step="1" required>
                        </div>
                        <div class="form-group">
                            <label for="status">ìƒíƒœ</label>
                            <select id="status" class="form-control">
                                <option value="ì •ìƒ">ì •ìƒ</option>
                                <option value="ê²€í† í•„ìš”">ê²€í† í•„ìš”</option>
                                <option value="ì´ˆê³¼">ì´ˆê³¼</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="registDate">ë“±ë¡ì¼ <span class="required">*</span></label>
                            <input type="date" id="registDate" class="form-control" required>
                        </div>
                    </div>

                    <!-- ì¶”ê°€ ì •ë³´ -->
                    <h3 style="margin-bottom: 1rem; color: #2c3e50;">ğŸ“ ì¶”ê°€ ì •ë³´ (ì„ íƒ)</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="projectName">í”„ë¡œì íŠ¸ëª…</label>
                            <input type="text" id="projectName" class="form-control" placeholder="ì˜ˆ: 2025-HAN-001">
                        </div>
                        <div class="form-group">
                            <label for="manager">ë‹´ë‹¹ì</label>
                            <input type="text" id="manager" class="form-control" placeholder="ì˜ˆ: ê¹€ì² ìˆ˜">
                        </div>
                        <div class="form-group">
                            <label for="quantity">ìˆ˜ëŸ‰</label>
                            <input type="number" id="quantity" class="form-control" placeholder="ê°œ" min="1">
                        </div>
                        <div class="form-group">
                            <label for="unit">ë‹¨ìœ„</label>
                            <select id="unit" class="form-control">
                                <option value="ê°œ">ê°œ</option>
                                <option value="ì„¸íŠ¸">ì„¸íŠ¸</option>
                                <option value="í†¤">í†¤</option>
                                <option value="kg">kg</option>
                            </select>
                        </div>
                    </div>

                    <!-- ë©”ëª¨ -->
                    <div class="form-group">
                        <label for="memo">ë©”ëª¨ ë° íŠ¹ì´ì‚¬í•­</label>
                        <textarea id="memo" class="form-control" rows="3" placeholder="ì¶”ê°€ ì •ë³´ë‚˜ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                    </div>

                    <!-- ë¹„ìš© ìš”ì•½ -->
                    <div class="cost-summary">
                        <div style="font-size: 1.1rem; margin-bottom: 0.5rem;">ì…ë ¥ëœ ì›ê°€</div>
                        <div class="cost-amount" id="costDisplay">â‚©0 ë§Œì›</div>
                    </div>

                    <!-- ì•¡ì…˜ ë²„íŠ¼ -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="clearManualForm()">
                            ğŸ—‘ï¸ ì´ˆê¸°í™”
                        </button>
                        <button type="button" class="btn btn-primary" onclick="previewManualData()">
                            ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°
                        </button>
                        <button type="submit" class="btn btn-success">
                            ğŸ’¾ ì €ì¥í•˜ê¸°
                        </button>
                    </div>
                </form>
            </div>

            <!-- ìƒì„¸ ëŒ€ì‹œë³´ë“œ íƒ­ -->
            <div id="dashboard" class="tab-pane">
                <h2 style="margin-bottom: 1.5rem;">ğŸ“Š ì›ê°€ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h2>

                <!-- ë¶„ë¥˜ í•„í„° -->
                <div class="filter-section">
                    <div class="filter-group">
                        <label>ëŒ€ë¶„ë¥˜:</label>
                        <select class="filter-select" id="majorFilter" onchange="updateFilters()">
                            <option value="">ì „ì²´</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>ì¤‘ë¶„ë¥˜:</label>
                        <select class="filter-select" id="middleFilter" onchange="updateFilters()">
                            <option value="">ì „ì²´</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>ì†Œë¶„ë¥˜:</label>
                        <select class="filter-select" id="minorFilter" onchange="updateFilters()">
                            <option value="">ì „ì²´</option>
                        </select>
                    </div>
                    <button class="btn btn-success" onclick="exportFilteredData()">
                        ğŸ’¾ í˜„ì¬ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                    </button>
                </div>

                <!-- ìš”ì•½ ì¹´ë“œ (ë‘ ë²ˆì§¸ íŒŒì¼ ìŠ¤íƒ€ì¼) -->
                <div class="summary-cards">
                    <div class="summary-card cost">
                        <div class="summary-value" id="totalCost">â‚©0</div>
                        <div class="summary-label">ì´ë‹¬ ì´ ì›ê°€</div>
                    </div>
                    <div class="summary-card production">
                        <div class="summary-value" id="totalCount">0ê°œ</div>
                        <div class="summary-label">ìƒì‚° ê¸ˆí˜• ìˆ˜</div>
                    </div>
                    <div class="summary-card efficiency">
                        <div class="summary-value" id="efficiency">0%</div>
                        <div class="summary-label">ëª©í‘œ ë‹¬ì„±ë¥ </div>
                    </div>
                    <div class="summary-card target">
                        <div class="summary-value" id="targetCost">â‚©1,890ë§Œ</div>
                        <div class="summary-label">ëª©í‘œ ì›ê°€</div>
                    </div>
                </div>

                <!-- ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ -->
                <div class="dashboard-grid">
                    <!-- ì›”ë³„ ì›ê°€ ì¶”ì´ ì°¨íŠ¸ -->
                    <div class="dashboard-card">
                        <div class="card-title">ğŸ“ˆ ì›”ë³„ ì›ê°€ ì¶”ì´</div>
                        <div class="chart-container">
                            <canvas id="monthlyChart"></canvas>
                        </div>
                    </div>

                    <!-- ê¸ˆí˜•ë³„ ì›ê°€ ë¶„í¬ -->
                    <div class="dashboard-card">
                        <div class="card-title">ğŸ¯ ê¸ˆí˜•ë³„ ì›ê°€ ë¶„í¬</div>
                        <div class="chart-container">
                            <canvas id="moldCostChart"></canvas>
                        </div>
                    </div>

                    <!-- ë¹ ë¥¸ ë°ì´í„° ì…ë ¥ ìœ„ì ¯ -->
                    <div class="dashboard-card">
                        <div class="card-title">âš¡ ë¹ ë¥¸ ë°ì´í„° ì…ë ¥</div>
                        <div class="quick-input-widget">
                            <div class="input-group">
                                <select id="quickMoldType" class="form-control">
                                    <option>ê¸ˆí˜• ì„ íƒ</option>
                                    <option>T0-ê°€ê³µë¹„</option>
                                    <option>T1-ì›ì¬ë£Œ</option>
                                    <option>ë¶€ì¬ë£Œ</option>
                                    <option>ì‹œì‚¬ì¶œë¹„</option>
                                    <option>ê¸°íƒ€</option>
                                </select>
                                <div class="input-row">
                                    <input type="date" id="quickDate" class="form-control" style="flex: 1">
									   </div>
                                <div class="input-row">
                                    <input type="number" id="quickCost" class="form-control" placeholder="ì›ê°€ ê¸ˆì•¡ (ë§Œì›)" style="flex: 2" min="0" step="1">
                                </div>
                                <button class="btn btn-success" style="width: 100%" onclick="quickSave()">
                                    ğŸ’¾ ì €ì¥í•˜ê¸°
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ìµœê·¼ ì›ê°€ í˜„í™© í…Œì´ë¸” -->
                    <div class="dashboard-card wide">
                        <div class="card-title">ğŸ“‹ ìµœê·¼ ì›ê°€ í˜„í™©</div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ê¸ˆí˜•ëª…</th>
                                    <th>ì›ê°€</th>
                                    <th>ìƒíƒœ</th>
                                    <th>ë“±ë¡ì¼</th>
                                </tr>
                            </thead>
                            <tbody id="recentDataTable">
                                <tr>
                                    <td>T0-ê°€ê³µë¹„</td>
                                    <td>â‚©185ë§Œ</td>
                                    <td><span class="status-badge status-normal">ì •ìƒ</span></td>
                                    <td>2025.09.04</td>
                                </tr>
                                <tr>
                                    <td>T1-ì›ì¬ë£Œ</td>
                                    <td>â‚©278ë§Œ</td>
                                    <td><span class="status-badge status-warning">ê²€í† í•„ìš”</span></td>
                                    <td>2025.09.03</td>
                                </tr>
                                <tr>
                                    <td>ë¶€ì¬ë£Œ</td>
                                    <td>â‚©92ë§Œ</td>
                                    <td><span class="status-badge status-normal">ì •ìƒ</span></td>
                                    <td>2025.09.03</td>
                                </tr>
                                <tr>
                                    <td>ì‹œì‚¬ì¶œë¹„</td>
                                    <td>â‚©156ë§Œ</td>
                                    <td><span class="status-badge status-danger">ì´ˆê³¼</span></td>
                                    <td>2025.09.02</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- ëª©í‘œ ë‹¬ì„± í˜„í™© -->
                    <div class="dashboard-card">
                        <div class="card-title">ğŸ¯ ëª©í‘œ ë‹¬ì„± í˜„í™©</div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <span class="progress-label">ì›ê°€ ì ˆê° ëª©í‘œ</span>
                                <span class="progress-value" style="color: #3498db" id="costReductionProgress">92.3%</span>
                            </div>
                            <div class="progress-bar-custom">
                                <div class="progress-fill-custom" style="width: 92.3%" id="costReductionBar"></div>
                            </div>
                        </div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <span class="progress-label">í’ˆì§ˆ ëª©í‘œ</span>
                                <span class="progress-value" style="color: #f39c12" id="qualityProgress">87.5%</span>
                            </div>
                            <div class="progress-bar-custom">
                                <div class="progress-fill-custom" 
                                     style="width: 87.5%; background: linear-gradient(90deg, #f39c12, #e67e22);"
                                     id="qualityBar"></div>
                            </div>
                        </div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <span class="progress-label">ë‚©ê¸° ì¤€ìˆ˜</span>
                                <span class="progress-value" style="color: #2ecc71" id="deliveryProgress">95.8%</span>
                            </div>
                            <div class="progress-bar-custom">
                                <div class="progress-fill-custom" 
                                     style="width: 95.8%; background: linear-gradient(90deg, #2ecc71, #27ae60);"
                                     id="deliveryBar"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ì•Œë¦¼ ë° ë©”ëª¨ -->
                    <div class="dashboard-card">
                        <div class="card-title">ğŸ”” ì•Œë¦¼ ë° ë©”ëª¨</div>
                        <div class="alert alert-warning">
                            <strong>âš ï¸ ì£¼ì˜ì‚¬í•­</strong>
                            ì‹œì‚¬ì¶œë¹„ ì›ê°€ê°€ ëª©í‘œë¥¼ 20% ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.
                        </div>
                        <div class="alert alert-success">
                            <strong>âœ… ì™„ë£Œì‚¬í•­</strong>
                            8ì›” ì›ê°€ ë³´ê³ ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.
                        </div>
                        <textarea placeholder="ì—…ë¬´ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”...

â€¢ ê²€í†  ì‚¬í•­
â€¢ ê°œì„  ê³„íš
â€¢ íŠ¹ì´ì‚¬í•­ ë“±" id="dashboardMemo"></textarea>
                    </div>
					
					
                </div>
            </div>

            <!-- ë°ì´í„° ëª©ë¡ íƒ­ -->
            <div id="list" class="tab-pane">
                <div class="table-container">
                    <div class="table-header">
                        <h2>ğŸ“‹ ì›ê°€ ë°ì´í„° ëª©ë¡</h2>
                        <div style="display: flex; gap: 1rem; align-items: center;">
                            <input type="text" placeholder="ê²€ìƒ‰..." id="searchInput" 
                                   style="padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;"
                                   onkeyup="filterTable()">
                            <button class="btn btn-success" onclick="exportToExcel()">
                                ğŸ“¤ ì—‘ì…€ ë‚´ë³´ë‚´ê¸°
                            </button>
                        </div>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th>ëŒ€ë¶„ë¥˜</th>
                                    <th>ì¤‘ë¶„ë¥˜</th>
                                    <th>ì†Œë¶„ë¥˜</th>
                                    <th>ê¸ˆí˜•ëª…</th>
                                    <th>ì›ê°€</th>
                                    <th>ìƒíƒœ</th>
                                    <th>ë“±ë¡ì¼</th>
                                    <th>ì…ë ¥ë°©ì‹</th>
                                    <th>ì‘ì—…</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody">
                                <tr>
                                    <td colspan="9" style="text-align: center; padding: 2rem; color: #7f8c8d;">
                                        ë°ì´í„°ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let globalData = [];
        let filteredData = [];
        let charts = {};

        // ë¶„ë¥˜ ì˜µì…˜ ë°ì´í„°
        const categoryOptions = {
            'ê°€ê³µ': {
                'T0': ['ê¸°ë³¸ê°€ê³µ', 'ì •ë°€ê°€ê³µ', 'íŠ¹ìˆ˜ê°€ê³µ'],
                'T1': ['1ì°¨ê°€ê³µ', '2ì°¨ê°€ê³µ', 'ë§ˆê°ê°€ê³µ'],
                'ê¸°íƒ€': ['ì‹œí—˜ê°€ê³µ', 'ìƒ˜í”Œê°€ê³µ']
            },
            'ì¬ë£Œ': {
                'T1': ['ì›ì¬ë£Œ', 'ë¶€ì¬ë£Œ', 'íŠ¹ìˆ˜ì¬ë£Œ'],
                'ì›ìì¬': ['í”Œë¼ìŠ¤í‹±', 'ê¸ˆì†', 'ê³ ë¬´'],
                'ì†Œëª¨í’ˆ': ['ë‚˜ì‚¬', 'ì ‘ì°©ì œ', 'ìœ¤í™œìœ ']
            },
            'ì¡°ë¦½': {
                'ê¸°ë³¸': ['ìˆ˜ë™ì¡°ë¦½', 'ìë™ì¡°ë¦½'],
                'ê²€ì‚¬': ['ì™¸ê´€ê²€ì‚¬', 'ê¸°ëŠ¥ê²€ì‚¬'],
                'í¬ì¥': ['1ì°¨í¬ì¥', '2ì°¨í¬ì¥']
            },
            'ê²€ì‚¬': {
                'í’ˆì§ˆ': ['ì¹˜ìˆ˜ê²€ì‚¬', 'ì™¸ê´€ê²€ì‚¬'],
                'ì„±ëŠ¥': ['ê¸°ëŠ¥ê²€ì‚¬', 'ë‚´êµ¬ì„±ê²€ì‚¬'],
                'ìµœì¢…': ['ì¶œí•˜ê²€ì‚¬', 'ìƒ˜í”Œê²€ì‚¬']
            },
            'ê¸°íƒ€': {
                'ê´€ë¦¬': ['ì¼ë°˜ê´€ë¦¬', 'íŠ¹ë³„ê´€ë¦¬'],
                'ê¸°íƒ€': ['ê¸°íƒ€1', 'ê¸°íƒ€2']
            }
        };

        // ì•Œë¦¼ í‘œì‹œ í•¨ìˆ˜
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.getElementById('notification');
            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                warning: 'âš ï¸',
                info: 'â„¹ï¸'
            };

            notification.innerHTML = `${icons[type]} ${message}`;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, duration);
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'dashboard' && globalData.length > 0) {
                setTimeout(() => {
                    updateDetailedDashboard();
                    initializeCharts();
                }, 100);
            }
        }

        // ë¶„ë¥˜ ì„ íƒ ì—…ë°ì´íŠ¸
        function updateCategoryOptions() {
            const majorSelect = document.getElementById('majorCategory');
            const middleSelect = document.getElementById('middleCategory');
            const minorSelect = document.getElementById('minorCategory');

            majorSelect.addEventListener('change', function() {
                const selectedMajor = this.value;
                middleSelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
                minorSelect.innerHTML = '<option value="">ì¤‘ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';

                if (selectedMajor && categoryOptions[selectedMajor]) {
                    Object.keys(categoryOptions[selectedMajor]).forEach(middle => {
                        middleSelect.innerHTML += `<option value="${middle}">${middle}</option>`;
                    });
                }
            });

            middleSelect.addEventListener('change', function() {
                const selectedMajor = majorSelect.value;
                const selectedMiddle = this.value;
                minorSelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';

                if (selectedMajor && selectedMiddle && categoryOptions[selectedMajor][selectedMiddle]) {
                    categoryOptions[selectedMajor][selectedMiddle].forEach(minor => {
                        minorSelect.innerHTML += `<option value="${minor}">${minor}</option>`;
                    });
                }
            });
        }

        // ìˆ˜ë™ ì…ë ¥ í¼ ì´ˆê¸°í™”
        function initializeManualForm() {
            updateCategoryOptions();
            document.getElementById('registDate').value = new Date().toISOString().split('T')[0];

            document.getElementById('cost').addEventListener('input', function() {
                const cost = parseInt(this.value) || 0;
                document.getElementById('costDisplay').textContent = `â‚©${cost.toLocaleString()} ë§Œì›`;
            });

            document.getElementById('manualForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveManualData();
            });
        }

        // ë¹ ë¥¸ ì…ë ¥ ì´ˆê¸°í™”
        function initializeQuickInput() {
            document.getElementById('quickDate').value = new Date().toISOString().split('T')[0];
        }

        // ìˆ˜ë™ ë°ì´í„° ì €ì¥
        function saveManualData() {
            const formData = {
                id: Date.now(),
                major: document.getElementById('majorCategory').value,
                middle: document.getElementById('middleCategory').value,
                minor: document.getElementById('minorCategory').value,
                moldName: document.getElementById('moldName').value,
                cost: parseInt(document.getElementById('cost').value) || 0,
                status: document.getElementById('status').value,
                date: document.getElementById('registDate').value,
                projectName: document.getElementById('projectName').value || '',
                manager: document.getElementById('manager').value || '',
                quantity: document.getElementById('quantity').value || '',
                unit: document.getElementById('unit').value || 'ê°œ',
                memo: document.getElementById('memo').value || '',
                inputMethod: 'ìˆ˜ë™ì…ë ¥'
            };

            if (!formData.major || !formData.middle || !formData.minor || !formData.moldName || !formData.cost || !formData.date) {
                showNotification('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }

            globalData.unshift(formData);
            filteredData = [...globalData];

            updateFilterOptions();
            updateTable();
            updateDetailedDashboard();

            showNotification('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            clearManualForm();

            setTimeout(() => {
                switchTab('list');
                const newRow = document.querySelector('#tableBody tr:first-child');
                if (newRow) {
                    newRow.classList.add('new-entry');
                    setTimeout(() => {
                        newRow.classList.remove('new-entry');
                    }, 2000);
                }
            }, 500);
        }

        // ë¹ ë¥¸ ì €ì¥
        function quickSave() {
            const moldType = document.getElementById('quickMoldType').value;
            const cost = parseInt(document.getElementById('quickCost').value) || 0;
            const date = document.getElementById('quickDate').value;

            if (moldType === 'ê¸ˆí˜• ì„ íƒ' || !cost || !date) {
                showNotification('ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }

            const formData = {
                id: Date.now(),
                major: 'ê°€ê³µ',
                middle: 'T0',
                minor: 'ê¸°ë³¸ê°€ê³µ',
                moldName: moldType,
                cost: cost,
                status: cost > 200 ? 'ê²€í† í•„ìš”' : 'ì •ìƒ',
                date: date,
                inputMethod: 'ë¹ ë¥¸ì…ë ¥'
            };

            globalData.unshift(formData);
            filteredData = [...globalData];

            // ë¹ ë¥¸ ì…ë ¥ í¼ ì´ˆê¸°í™”
            document.getElementById('quickMoldType').value = 'ê¸ˆí˜• ì„ íƒ';
            document.getElementById('quickCost').value = '';

            updateFilterOptions();
            updateTable();
            updateDetailedDashboard();
            updateRecentTable();

            showNotification('ë¹ ë¥¸ ì…ë ¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        // ìµœê·¼ ë°ì´í„° í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateRecentTable() {
            const tbody = document.getElementById('recentDataTable');
            const recentData = globalData.slice(0, 4); // ìµœê·¼ 4ê°œë§Œ

            if (recentData.length > 0) {
                tbody.innerHTML = recentData.map(item => `
                    <tr>
                        <td>${item.moldName}</td>
                        <td>â‚©${item.cost}ë§Œ</td>
                        <td><span class="status-badge ${getStatusClass(item.status)}">${item.status}</span></td>
                        <td>${item.date}</td>
                    </tr>
                `).join('');
            }
        }

        // ìˆ˜ë™ í¼ ì´ˆê¸°í™”
        function clearManualForm() {
            document.getElementById('manualForm').reset();
            document.getElementById('registDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('costDisplay').textContent = 'â‚©0 ë§Œì›';

            document.getElementById('middleCategory').innerHTML = '<option value="">ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';
            document.getElementById('minorCategory').innerHTML = '<option value="">ì¤‘ë¶„ë¥˜ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';
        }

        // ìˆ˜ë™ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
        function previewManualData() {
            const major = document.getElementById('majorCategory').value;
            const middle = document.getElementById('middleCategory').value;
            const minor = document.getElementById('minorCategory').value;
            const moldName = document.getElementById('moldName').value;
            const cost = document.getElementById('cost').value;
            const status = document.getElementById('status').value;
            const date = document.getElementById('registDate').value;

            if (!major || !middle || !minor || !moldName || !cost || !date) {
                showNotification('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'warning');
                return;
            }

            const previewText = `
ë¯¸ë¦¬ë³´ê¸°:

ë¶„ë¥˜: ${major} > ${middle} > ${minor}
ê¸ˆí˜•ëª…: ${moldName}
ì›ê°€: â‚©${parseInt(cost).toLocaleString()}ë§Œì›
ìƒíƒœ: ${status}
ë“±ë¡ì¼: ${date}
            `.trim();

            alert(previewText);
        }

        // ìƒì„¸ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
        function updateDetailedDashboard() {
            if (filteredData.length === 0) {
                // ê¸°ë³¸ ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
                document.getElementById('totalCost').textContent = 'â‚©0';
                document.getElementById('totalCount').textContent = '0ê°œ';
                document.getElementById('efficiency').textContent = '0%';
                return;
            }

            const totalCost = filteredData.reduce((sum, item) => sum + item.cost, 0);
            const totalCount = filteredData.length;
            const targetCost = 1890; // ëª©í‘œ ì›ê°€ (ë§Œì›)
            const efficiency = Math.min(100, Math.round((targetCost / (totalCost || 1)) * 100));

            document.getElementById('totalCost').textContent = 'â‚©' + totalCost.toLocaleString() + 'ë§Œ';
            document.getElementById('totalCount').textContent = totalCount + 'ê°œ';
            document.getElementById('efficiency').textContent = efficiency + '%';

            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            updateProgressBars(efficiency);
        }

        // ì§„í–‰ë¥  ë°” ì—…ë°ì´íŠ¸
        function updateProgressBars(efficiency) {
            const costReductionProgress = Math.min(100, efficiency);
            const qualityProgress = Math.min(100, efficiency - 5);
            const deliveryProgress = Math.min(100, efficiency + 3);

            document.getElementById('costReductionProgress').textContent = costReductionProgress + '%';
            document.getElementById('costReductionBar').style.width = costReductionProgress + '%';

            document.getElementById('qualityProgress').textContent = qualityProgress + '%';
            document.getElementById('qualityBar').style.width = qualityProgress + '%';

            document.getElementById('deliveryProgress').textContent = deliveryProgress + '%';
            document.getElementById('deliveryBar').style.width = deliveryProgress + '%';
        }

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initializeCharts() {
            // ì›”ë³„ ì›ê°€ ì¶”ì´ ì°¨íŠ¸
            const monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
            if (charts.monthly) {
                charts.monthly.destroy();
            }

            charts.monthly = new Chart(monthlyCtx, {
                type: 'line',
                data: {
                    labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”'],
                    datasets: [
                        {
                            label: 'ì‹¤ì œ ì›ê°€',
                            data: [2200, 2350, 2180, 2420, 2300, 2150, 2380, 2290, filteredData.reduce((sum, item) => sum + item.cost, 0) || 2450],
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#3498db',
                            pointBorderColor: '#ffffff',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                        },
                        {
                            label: 'ëª©í‘œ ì›ê°€',
                            data: [2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000],
                            borderColor: '#e74c3c',
                            borderDash: [8, 4],
                            fill: false,
                            pointRadius: 0,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                            },
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#3498db',
                            borderWidth: 1,
                            cornerRadius: 8,
                        },
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false,
                            },
                        },
                        y: {
                            beginAtZero: false,
                            min: 1800,
                            ticks: {
                                callback: function (value) {
                                    return 'â‚©' + value + 'ë§Œ';
                                },
                            },
                            grid: {
                                color: 'rgba(0,0,0,0.05)',
                            },
                        },
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index',
                    },
                },
            });

            // ê¸ˆí˜•ë³„ ì›ê°€ ë¶„í¬ ì°¨íŠ¸
            const moldCostCtx = document.getElementById('moldCostChart').getContext('2d');
            if (charts.distribution) {
                charts.distribution.destroy();
            }

            // ì‹¤ì œ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ìƒ˜í”Œ ë°ì´í„° ì‚¬ìš©
            let chartData, chartLabels;
            if (filteredData.length > 0) {
                const costByMold = {};
                filteredData.forEach(item => {
                    costByMold[item.moldName] = (costByMold[item.moldName] || 0) + item.cost;
                });
                chartLabels = Object.keys(costByMold);
                chartData = Object.values(costByMold);
            } else {
                chartLabels = ['T0-ê°€ê³µë¹„', 'T1-ì›ì¬ë£Œ', 'ë¶€ì¬ë£Œ', 'ì‹œì‚¬ì¶œë¹„', 'ê¸°íƒ€'];
                chartData = [185, 278, 92, 156, 89];
            }

            charts.distribution = new Chart(moldCostCtx, {
                type: 'doughnut',
                data: {
                    labels: chartLabels,
                    datasets: [
                        {
                            data: chartData,
                            backgroundColor: [
                                '#3498db',
                                '#e74c3c',
                                '#2ecc71',
                                '#f39c12',
                                '#9b59b6',
                            ],
                            borderWidth: 3,
                            borderColor: '#ffffff',
                            hoverBorderWidth: 5,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 12,
                                },
                            },
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#ffffff',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function (context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: â‚©${value}ë§Œ (${percentage}%)`;
                                },
                            },
                        },
                    },
                    cutout: '60%',
                },
            });
        }

        // ì—‘ì…€ ì—…ë¡œë“œ ê´€ë ¨ í•¨ìˆ˜ë“¤ (ê¸°ì¡´ê³¼ ë™ì¼)
        function initializeUpload() {
            const uploadZone = document.getElementById('uploadZone');
            const fileInput = document.getElementById('fileInput');

            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('dragover');
            });

            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('dragover');
            });

            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
        }

        function handleFile(file) {
            if (!file.name.match(/\.(xlsx|xls)$/i)) {
                showAlert('Excel íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'error');
                return;
            }

            showProgress(true);

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    processExcelData(e.target.result);
                } catch (error) {
                    showAlert('íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
                    showProgress(false);
                }
            };
            reader.readAsBinaryString(file);
        }

        function processExcelData(data) {
            const workbook = XLSX.read(data, { type: 'binary' });
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1, defval: "" });

            if (rows.length < 2) {
                showAlert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                showProgress(false);
                return;
            }

            const headers = rows[0].map(h => String(h).trim());
            const requiredColumns = ['ëŒ€ë¶„ë¥˜', 'ì¤‘ë¶„ë¥˜', 'ì†Œë¶„ë¥˜', 'ê¸ˆí˜•ëª…', 'ì›ê°€', 'ìƒíƒœ', 'ë“±ë¡ì¼'];
            const columnIndexes = {};

            requiredColumns.forEach(col => {
                const index = headers.indexOf(col);
                if (index === -1) {
                    showAlert(`í•„ìˆ˜ ì»¬ëŸ¼ '${col}'ì´ ì—†ìŠµë‹ˆë‹¤.`, 'error');
                    showProgress(false);
                    return;
                }
                columnIndexes[col] = index;
            });

            const parsedData = [];
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (!row[columnIndexes['ê¸ˆí˜•ëª…']] || !row[columnIndexes['ì›ê°€']]) continue;

                const costStr = String(row[columnIndexes['ì›ê°€']]).replace(/[^\d]/g, '');
                const cost = parseInt(costStr) || 0;

                parsedData.push({
                    id: Date.now() + i,
                    major: String(row[columnIndexes['ëŒ€ë¶„ë¥˜']] || ''),
                    middle: String(row[columnIndexes['ì¤‘ë¶„ë¥˜']] || ''),
                    minor: String(row[columnIndexes['ì†Œë¶„ë¥˜']] || ''),
                    moldName: String(row[columnIndexes['ê¸ˆí˜•ëª…']]),
                    cost: cost,
                    status: String(row[columnIndexes['ìƒíƒœ']] || 'ì •ìƒ'),
                    date: String(row[columnIndexes['ë“±ë¡ì¼']] || new Date().toISOString().split('T')[0]),
                    inputMethod: 'ì—‘ì…€ì—…ë¡œë“œ'
                });
            }

            globalData = [...parsedData, ...globalData];
            filteredData = [...globalData];

            animateProgress(() => {
                showAlert(`${parsedData.length}ê±´ì˜ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
                updateFilterOptions();
                updateTable();
                updateDetailedDashboard();
                updateRecentTable();
                showProgress(false);
            });
        }

        function showProgress(show) {
            document.getElementById('progressContainer').style.display = show ? 'block' : 'none';
            if (!show) {
                document.getElementById('progressFill').style.width = '0%';
                document.getElementById('progressText').textContent = '0%';
            }
        }

        function animateProgress(callback) {
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(callback, 500);
                }
                document.getElementById('progressFill').style.width = progress + '%';
                document.getElementById('progressText').textContent = Math.round(progress) + '%';
            }, 100);
        }

        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.innerHTML = `
                <span>${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸'}</span>
                <span>${message}</span>
            `;

            const result = document.getElementById('uploadResult');
            result.innerHTML = '';
            result.appendChild(alertDiv);

            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        function updateFilterOptions() {
            const majors = [...new Set(globalData.map(item => item.major))].filter(Boolean);
            const middles = [...new Set(globalData.map(item => item.middle))].filter(Boolean);
            const minors = [...new Set(globalData.map(item => item.minor))].filter(Boolean);

            updateSelectOptions('majorFilter', majors);
            updateSelectOptions('middleFilter', middles);
            updateSelectOptions('minorFilter', minors);
        }

        function updateSelectOptions(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            select.innerHTML = '<option value="">ì „ì²´</option>';

            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });

            if (options.includes(currentValue)) {
                select.value = currentValue;
            }
        }

        function updateFilters() {
            const majorFilter = document.getElementById('majorFilter').value;
            const middleFilter = document.getElementById('middleFilter').value;
            const minorFilter = document.getElementById('minorFilter').value;

            filteredData = globalData.filter(item => {
                return (!majorFilter || item.major === majorFilter) &&
                       (!middleFilter || item.middle === middleFilter) &&
                       (!minorFilter || item.minor === minorFilter);
            });

            updateTable();
            updateDetailedDashboard();
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="9" style="text-align: center; padding: 2rem; color: #7f8c8d;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                return;
            }

            tbody.innerHTML = filteredData.map(item => `
                <tr>
                    <td>${item.major}</td>
                    <td>${item.middle}</td>
                    <td>${item.minor}</td>
                    <td>${item.moldName}</td>
                    <td>â‚©${item.cost.toLocaleString()}ë§Œ</td>
                    <td><span class="status-badge ${getStatusClass(item.status)}">${item.status}</span></td>
                    <td>${item.date}</td>
                    <td><span style="font-size: 0.8em; color: #666;">${item.inputMethod || 'ì—‘ì…€ì—…ë¡œë“œ'}</span></td>
                    <td>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-edit" onclick="editItem(${item.id})">ìˆ˜ì •</button>
                            <button class="btn btn-delete" onclick="deleteItem(${item.id})">ì‚­ì œ</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function getStatusClass(status) {
            switch(status) {
                case 'ì •ìƒ': return 'status-normal';
                case 'ì´ˆê³¼': return 'status-danger';
                default: return 'status-warning';
            }
        }

        function filterTable() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#tableBody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function exportToExcel() {
            if (filteredData.length === 0) {
                showNotification('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'warning');
                return;
            }

            const exportData = [
                ['ëŒ€ë¶„ë¥˜', 'ì¤‘ë¶„ë¥˜', 'ì†Œë¶„ë¥˜', 'ê¸ˆí˜•ëª…', 'ì›ê°€', 'ìƒíƒœ', 'ë“±ë¡ì¼', 'ì…ë ¥ë°©ì‹']
            ];

            filteredData.forEach(item => {
                exportData.push([
                    item.major, item.middle, item.minor, item.moldName,
                    item.cost, item.status, item.date, item.inputMethod || 'ì—‘ì…€ì—…ë¡œë“œ'
                ]);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(exportData);
            XLSX.utils.book_append_sheet(wb, ws, "ì›ê°€ë°ì´í„°");

            const fileName = `SCMS_ì›ê°€ê´€ë¦¬ë°ì´í„°_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);

            showNotification('ì—‘ì…€ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        function downloadSample() {
            const sampleData = [
                ['ëŒ€ë¶„ë¥˜', 'ì¤‘ë¶„ë¥˜', 'ì†Œë¶„ë¥˜', 'ê¸ˆí˜•ëª…', 'ì›ê°€', 'ìƒíƒœ', 'ë“±ë¡ì¼'],
                ['ê°€ê³µ', 'T0', 'ê¸°ë³¸ê°€ê³µ', 'ì‹œì‚¬ì¶œë¹„', '50', 'ì •ìƒ', '2025-09-08'],
                ['ì¬ë£Œ', 'T1', 'ì›ì¬ë£Œ', 'ë¶€ì¬ë£Œ', '5000', 'ê²€í† í•„ìš”', '2025-09-08'],
                ['ê°€ê³µ', 'T0', 'ì •ë°€ê°€ê³µ', 'T0-ê°€ê³µë¹„', '185', 'ì •ìƒ', '2025-09-04'],
                ['ì¬ë£Œ', 'T1', 'íŠ¹ìˆ˜ì¬ë£Œ', 'T1-ì›ì¬ë£Œ', '278', 'ê²€í† í•„ìš”', '2025-09-03']
            ];

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(sampleData);
            XLSX.utils.book_append_sheet(wb, ws, "ìƒ˜í”Œë°ì´í„°");

            XLSX.writeFile(wb, "SCMS_ìƒ˜í”ŒíŒŒì¼.xlsx");
            showNotification('ìƒ˜í”Œ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        function editItem(id) {
            showNotification('ìˆ˜ì • ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.', 'info');
        }

        function deleteItem(id) {
            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                globalData = globalData.filter(item => item.id !== id);
                updateFilters();
                updateDetailedDashboard();
                updateRecentTable();
                showNotification('ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            }
        }

        function exportFilteredData() {
            exportToExcel();
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            initializeUpload();
            initializeManualForm();
            initializeQuickInput();
            initializeCharts();
            showNotification('SCMS í†µí•© ì›ê°€ê´€ë¦¬ ì‹œìŠ¤í…œì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success', 4000);
        });
    </script>
</body>
</html>
